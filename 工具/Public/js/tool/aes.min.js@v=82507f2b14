$(document).ready(function(){function r(t){return CryptoJS.lib.WordArray.random(t)}$("#aes-mode").change(function(){"ECB"==$(this).val()?($("#aes-iv").val(""),$(".iv-ele").prop("disabled",!0)):$(".iv-ele").prop("disabled",!1)}),$(".btn-action").click(function(){$(".tool-result").hide(),$("#tool-result-btn").hide(),tips_clear();var t=$("#tool-text").val();if(t.length<=0)return tips_error("请输入初始文本！"),$("#tool-text").focus(),!1;var e=$(this).data("action"),r=$("#aes-mode").val(),o=$("#aes-padding").val(),n=$("#aes-key").val(),l=$("#aes-keyType").val(),a=$("#aes-iv").val(),i=$("#aes-ivType").val();if("Utf8"!=l)n=CryptoJS.enc[l].parse(n);"Hex"==l&&""==a&&tips_error("密钥为Hex时，请设置偏移量IV。");var s={};"ECB"!==r&&""!=a&&(s.iv=CryptoJS.enc[i].parse(a)),s.mode=CryptoJS.mode[r],s.padding=CryptoJS.pad[o];var c="";if("encrypt"==e)c=CryptoJS.AES.encrypt(t,n,s).toString();else try{c=CryptoJS.AES.decrypt(t,n,s).toString(CryptoJS.enc.Utf8),$("#tool-result-btn").show()}catch(t){tips_error("解密失败，请检查原文、密匙及模式是否正确")}c=c||"解密失败，请检查原文、密匙及模式是否正确",$("#tool-result").html(c),$(".tool-result").show()}),$(".btn-clear").on("click",function(){$(".tool-result").hide(),$("#tool-result-btn").hide(),tips_clear(),$("#tool-text").val("")}),$("#genStd").on("click",function(){var t=r(32),e=r(16);$("#aes-key").val(CryptoJS.enc.Hex.stringify(t)),$("#aes-keyType").val("Hex"),$("#aes-iv").val(CryptoJS.enc.Hex.stringify(e)),$("#aes-ivType").val("Hex")}),$("#genKey").on("click",function(){var t=r(16);$("#aes-key").val(CryptoJS.enc.Hex.stringify(t)),$("#aes-keyType").val("Hex")}),$("#genIV").on("click",function(){var t=r(16);$("#aes-iv").val(CryptoJS.enc.Hex.stringify(t)),$("#aes-ivType").val("Hex")}),$("#btnJsonFormat").on("click",function(){try{var t=$("#tool-result").html().trim(),e=JSON.parse(t),r=JSON.stringify(e,null,4);$("#tool-result").html("<pre>"+r+"</pre>")}catch(t){return tips_error("JSON 格式错误: "+t.message),!1}}),$("#btnAscii2Native").on("click",function(){for(var t=$("#tool-result").html().trim().split("\\u"),e=t[0],r=1;r<t.length;r++){var o=t[r];e+=String.fromCharCode(parseInt("0x"+o.substring(0,4))),4<o.length&&(e+=o.substring(4,o.length))}$("#tool-result").html(e)})});