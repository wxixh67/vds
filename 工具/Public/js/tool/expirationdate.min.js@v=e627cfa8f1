function initSelect(t,e,r){for(var a=e;a<=r;a++){var n=a.toString();a<=9&&(n="0"+n),t.append($("<option>",{value:n,text:n}))}}function selectYmd(t,e,r){var a,n=parseInt(e.val());parseInt(r.val());4==n||6==n||9==n||11==n?a=30:2==n?(a=28,y=parseInt(t.val()),(y%4==0&&y%100!=0||y%400==0)&&(a=29)):a=31,r.empty(),initSelect(r,1,a)}$(function(){var s=$("#from_year"),l=$("#from_month"),m=$("#from_day"),c=$("#from_hour"),f=$("#from_minute");s.val(moment().format("YYYY")),l.val(moment().format("MM")),m.val(moment().format("DD")),c.val(moment().format("hh")),f.val(moment().format("mm")),s.change(function(){selectYmd(s,l,m)}),l.change(function(){selectYmd(s,l,m)});var p=$("#btn-get-date");p.click(function(){var t=parseInt(s.val()),e=parseInt(l.val()),r=parseInt(m.val()),a=parseInt(c.val()),n=parseInt(f.val()),o=parseInt($("input[name='from_num']").val()),i=$("select[name='from_type']").val();return""==t?(tips_error("请填写开始年份！"),s.focus(),!1):""==e?(tips_error("请填写开始月份！"),l.focus(),!1):""==r?(tips_error("请填写开始日子！"),m.focus(),!1):o<0?(tips_error("请填写正确的条件！"),$("input[name='from_num']").focus(),!1):"Invalid Date"==new Date(t,e-1,r)?(tips_error("请输入正确的日期！"),!1):(p.attr("disabled","disabled"),tips_loading(),void $.ajax({type:"post",dataType:"json",data:{star_datetime:t+"-"+e+"-"+r+" "+a+":"+n+":00",type:i,num:o},url:WW_URL+"ajax",success:function(t){if(1==t.status){tips_clear();var e="日期";"hour"!=i&&"minute"!=i||(e="时间");var r="";r+="开启"+e+"："+t.data.star_datetime,r+="<br/>失效"+e+"："+t.data.over_datetime,$("#tool-result-text").html(r),$("#tool-result").show()}else $("#tool-result").hide(),tips_error(t.info);p.removeAttr("disabled","disabled")}}))});var o=0;$.fn.printArea=function(){var t=$(this),e="printArea_";i(e+o);var r=e+ ++o;iframe=document.createElement("IFRAME"),$(iframe).attr({style:"position:absolute;width:0px;height:0px;left:-500px;top:-500px;",id:r}),document.body.appendChild(iframe);var a=iframe.contentWindow.document;$(document).find("link").filter(function(){return"stylesheet"==$(this).attr("rel").toLowerCase()}).each(function(){a.write('<link type="text/css" rel="stylesheet" href="'+$(this).attr("href")+'" >')}),a.write('<div class="'+$(t).attr("class")+'">'+$(t).html()+"</div>"),a.close();var n=iframe.contentWindow;n.close(),n.focus(),n.print()};var i=function(t){$("iframe#"+t).remove()};$(".btn-print").click(function(){$("#tool-result-text").printArea()})});