function cssbeautify(e,t){"use strict";var n,r,i,o,c,l,f,s,u,a,h,p=0,g=e.length,S="",d=!0;function A(e){return" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e}function m(e){return"'"===e||'"'===e}function b(e){return"a"<=i&&i<="z"||"A"<=i&&i<="Z"||"0"<=i&&i<="9"||0<="-_*.:#".indexOf(e)}function y(){var e;for(e=s;0<e;e-=1)S+=n.indent}function R(){S=h(S),d?S+=" {":(S+="\n",y(),S+="{"),"\n"!==o&&(S+="\n"),s+=1}function k(){s-=1,S=h(S),S+="\n",y(),S+="}",r.push(S),S=""}for(void 0===(n=1<arguments.length?t:{}).indent&&(n.indent="    "),"string"==typeof n.openbrace&&(d="end-of-line"===n.openbrace),h=String.prototype.trimRight?function(e){return e.trimRight()}:function(e){return e.replace(/\s+$/,"")},l=(f={Start:s=0,AtRule:1,Block:2,Selector:3,Ruleset:4,Property:5,Separator:6,Expression:7}).Start,a=!1,r=[],e=e.replace(/\r\n/g,"\n");p<g;)if(i=e.charAt(p),o=e.charAt(p+1),p+=1,m(u))S+=i,i===u&&(u=null),"\\"===i&&o===u&&(S+=o,p+=1);else if(m(i))S+=i,u=i;else if(a)S+=i,"*"===i&&"/"===o&&(a=!1,S+=o,p+=1);else if("/"!==i||"*"!==o){if(l===f.Start){if(0===r.length&&A(i)&&0===S.length)continue;if(i<=" "||128<=i.charCodeAt(0)){l=f.Start,S+=i;continue}if(b(i)||"@"===i){if(0===(c=h(S)).length)0<r.length&&(S="\n\n");else if("}"===c.charAt(c.length-1)||";"===c.charAt(c.length-1))S=c+"\n\n";else for(;" "===(o=S.charAt(S.length-1))||9===o.charCodeAt(0);)S=S.substr(0,S.length-1);S+=i,l="@"===i?f.AtRule:f.Selector;continue}}if(l!==f.AtRule)if(l!==f.Block)if(l!==f.Selector)if(l!==f.Ruleset)if(l!==f.Property)if(l!==f.Separator)if(l!==f.Expression)S+=i;else{if("}"===i){k(),l=f.Start,0<s&&(l=f.Block);continue}if(";"===i){S=h(S),S+=";\n",l=f.Ruleset;continue}S+=i}else{if(!A(i)){S+=i,l=f.Expression;continue}m(o)&&(l=f.Expression)}else{if(":"===i){S=h(S),S+=": ",l=f.Expression,A(o)&&(l=f.Separator);continue}if("}"===i){k(),l=f.Start,0<s&&(l=f.Block);continue}S+=i}else{if("}"===i){k(),l=f.Start,0<s&&(l=f.Block);continue}if("\n"===i){S=h(S),S+="\n";continue}if(!A(i)){S=h(S),S+="\n",y(),S+=i,l=f.Property;continue}S+=i}else{if("{"===i){R(),l=f.Ruleset;continue}if("}"===i){k(),l=f.Start;continue}S+=i}else{if(b(i)){if(0===(c=h(S)).length)0<r.length&&(S="\n\n");else if("}"===c.charAt(c.length-1))S=c+"\n\n";else for(;" "===(o=S.charAt(S.length-1))||9===o.charCodeAt(0);)S=S.substr(0,S.length-1);y(),S+=i,l=f.Selector;continue}if("}"===i){k(),l=f.Start;continue}S+=i}else{if(";"===i){S+=i,l=f.Start;continue}if("{"===i){R(),l=f.Block;continue}S+=i}}else a=!0,S+=i,S+=o,p+=1;return S=r.join("")+S}function css_format(){var e,t=$.trim($("#tool-form").val());if(""==t)return tips_error("请填写需要格式的css代码！"),$("#tool-form").focus(),!1;e={indent:"    "},document.getElementById("tab").checked&&(e.indent="\t"),document.getElementById("openbrace-separate-line").checked&&(e.openbrace="separate-line");var n=cssbeautify(t,e);$("#tool-result").val(n),tips_clear()}