function exportCSV(t){for(var o="data:text/csv;charset=utf-8,",r=0;r<t.length;r++){o+=t[r].map(function(t){return null==t&&(t=""),t=String(t),/[",\n]/.test(t)&&(t='"'+t.replace(/"/g,'""')+'"'),t}).join(",")+"\n"}var e=document.createElement("a");e.setAttribute("href",encodeURI(o)),e.setAttribute("download","result.csv"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}$(function(){$("#btnGetpoint").click(function(){!function(){var t=$("#tool-text").val().trim(),o=$("input[name='crs_type']:checked").val();if(""==t)return tips_error("请填写需要转换的坐标！"),$("#tool-text").focus();if(1e4<t.length)return tips_error("输入字符长度不能超过10000！"),$("#tool-text").focus();tips_clear();var r=[];r.push(["WGS84","GCJ02","BD09"]);var e=t.split(/[\r\n]+/g),n=(e.length,{GCJ02:gcoord.GCJ02,WGS84:gcoord.WGS84,BD09:gcoord.BD09}),c="<div class='table-scroll-x'><table class='table'><thead><tr><th>No.</th><th>WGS84</th><th>GCJ02</th><th>BD09</th></thead><tbody>";for(key in e){var d=e[key].replace(" ","").replace("，",","),a=(d=d.split(","))[0],l=d[1],i="错误坐标",s="错误坐标",h="错误坐标";c+="<tr>",c+="<td>"+(parseInt(key)+1)+"</td>";try{var u=gcoord.transform([a,l],n[o],gcoord.WGS84);c+="<td>"+u.join(",")+"</td>",i=u.join(",")}catch(t){c+="<td>错误坐标</td>"}try{var p=gcoord.transform([a,l],n[o],gcoord.GCJ02);c+="<td>"+p.join(",")+"</td>",s=p.join(",")}catch(t){c+="<td>错误坐标</td>"}try{var f=gcoord.transform([a,l],n[o],gcoord.BD09);c+="<td>"+f.join(",")+"</td>",h=f.join(",")}catch(t){c+="<td>错误坐标</td>"}c+="</tr>",r.push([i,s,h])}c+="</tbody></table></div>",$("#tool-result").html(c).show(),$("#btnDownload").off("click").on("click",function(){exportCSV(r)})}()}),$("#btnExample").click(function(){$("#tool-text").val("116.403506,39.923958\n121.480391,31.236259\n113.270862,23.135608\n108.966716,34.337115\n114.349573,30.579763"),$("#btnGetpoint").trigger("click")})});