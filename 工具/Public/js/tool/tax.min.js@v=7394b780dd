$(document).ready(function(){$("#tax_point-0,#tax_point-1,#tax_point-3").on("change",function(){""!=$(this).val()?localStorage.setItem("wawa_local_tax_point",$(this).val()):localStorage.removeItem("wawa_local_tax_point")});var t=localStorage.getItem("wawa_local_tax_point");function r(t,a,e){if(1==a){var o='<table class="table table-bordered" width="100%"><thead><tr><th width="22%">项目</th><th width="32%">金额</th><th>大写</th></tr></thead><tbody>';o+='<tr><td>含税金额</td><td class="btn-copyit" data-clipboard-text="'+t.money_with_tax+'">'+t.money_with_tax+'</td><td class="btn-copyit" data-clipboard-text="'+t.money_with_tax_daxie+'">'+t.money_with_tax_daxie+"</td></tr>",o+='<tr><td>未税金额</td><td class="btn-copyit" data-clipboard-text="'+t.money_no_tax+'">'+t.money_no_tax+'</td><td class="btn-copyit" data-clipboard-text="'+t.money_no_tax_daxie+'">'+t.money_no_tax_daxie+"</td></tr>",o+='<tr><td>税额</td><td class="btn-copyit" data-clipboard-text="'+t.tax_money+'">'+t.tax_money+'</td><td class="btn-copyit" data-clipboard-text="'+t.tax_money_daxie+'">'+t.tax_money_daxie+"</td></tr>",o+='<tr><td>税率</td><td colspan="2" class="btn-copyit" data-clipboard-text="'+t.tax+'%">'+t.tax+"%</td></tr>",o+='<tr><td>免税额</td><td colspan="2" class="btn-copyit" data-clipboard-text="'+t.tax_exemption+'">'+t.tax_exemption+"</td></tr>",o+="</tbody></table>"}else{o='<div class="tool-result"><p id="tool-result-text-'+e+'">';o+="含税金额：￥"+t.money_with_tax+"元 ("+t.money_with_tax_daxie+")</br>",o+="未税金额：￥"+t.money_no_tax+"元 ("+t.money_no_tax_daxie+")</br>",o+="税额：￥"+t.tax_money+"元 ("+t.tax_money_daxie+")</br>",o+="税率："+t.tax+"%</br>",o+="免税额：￥"+t.tax_exemption,o+='</p><div class="btn-list"><input class="btn btn-copy-p" type="button" value="复制" data-clipboard-target="#tool-result-text-'+e+'"></div></div>'}return o}null!=t?$("#tax_point-0,#tax_point-1,#tax_point-3").val(t):$("#tax_point-0,#tax_point-1,#tax_point-3").val("13"),$("#btn-get-withtax").click(function(){var e=$("input[name='res_format']:checked").val(),t=$("#money_notax-0").val(),a=$("#tax_point-0").val(),o=$("#tax_exemption-0").val();if(""==t)return tips_error("请填写未含税金额！"),$("#money_notax-0").focus(),!1;if(""==a)return tips_error("请填写税率！"),$("#tax_point-0").focus(),!1;var n=$(".btn-success");n.attr("disabled","disabled"),tips_loading(),$.ajax({type:"post",dataType:"json",data:{type:0,money_notax:t,tax_point:a,tax_exemption:o},url:WW_URL+"ajax",success:function(t){if(1==t.status){tips_clear();var a=r(t.data,e,"0");$("#tool-result-0").html(a).show()}else tips_error(t.info);n.removeAttr("disabled","disabled")}})}),$("#btn-get-notax").click(function(){var e=$("input[name='res_format']:checked").val(),t=$("#money_withtax-1").val(),a=$("#tax_point-1").val(),o=$("#tax_exemption-1").val(),n=$("#tool-tips-1");if(""==t)return tips_error("请填写含税总金额！",n),$("#money_withtax-1").focus(),!1;if(""==a)return tips_error("请填写税率！",n),$("#tax_point-1").focus(),!1;var i=$(".btn-success");i.attr("disabled","disabled"),tips_loading(n),$.ajax({type:"post",dataType:"json",data:{type:1,money_withtax:t,tax_point:a,tax_exemption:o},url:WW_URL+"ajax",success:function(t){if(1==t.status){tips_clear(n);var a=r(t.data,e,"1");$("#tool-result-1").html(a).show()}else tips_error(t.info,n);i.removeAttr("disabled","disabled")}})}),$("#btn-get-tax").click(function(){var e=$("input[name='res_format']:checked").val(),t=$("#money_notax-2").val(),a=$("#money_withtax-2").val(),o=$("#tax_exemption-2").val(),n=$("#tool-tips-2");if(""==t)return tips_error("请填写未税金额！",n),$("#money_notax-2").focus(),!1;if(""==a)return tips_error("请填写含税总金额！",n),$("#money_withtax-2").focus(),!1;var i=$(".btn-success");i.attr("disabled","disabled"),tips_loading(n),$.ajax({type:"post",dataType:"json",data:{type:2,money_notax:t,money_withtax:a,tax_exemption:o},url:WW_URL+"ajax",success:function(t){if(1==t.status){tips_clear(n);var a=r(t.data,e,"2");$("#tool-result-2").html(a).show()}else tips_error(t.info,n);i.removeAttr("disabled","disabled")}})}),$("#btn-get-taxmoney").click(function(){var e=$("input[name='res_format']:checked").val(),t=$("#tax_amount-3").val(),a=$("#tax_point-3").val(),o=$("#tax_exemption-3").val(),n=$("#tax_point-3");if(""==t)return tips_error("请填写税额！",n),$("#tax_amount-3").focus(),!1;if(""==a)return tips_error("请填写税率！",n),$("#tax_point-3").focus(),!1;var i=$(".btn-success");i.attr("disabled","disabled"),tips_loading(n),$.ajax({type:"post",dataType:"json",data:{type:3,tax_amount:t,tax_point:a,tax_exemption:o},url:WW_URL+"ajax",success:function(t){if(1==t.status){tips_clear(n);var a=r(t.data,e,"2");$("#tool-result-3").html(a).show()}else tips_error(t.info,n);i.removeAttr("disabled","disabled")}})});var a=new Clipboard(".btn-copyit");a.on("success",function(t){var a=t.trigger.innerHTML;t.trigger.innerHTML="已复制",setTimeout(function(){t.trigger.innerHTML=a},2e3)}),a.on("error",function(t){alert("复制失败，请手动操作。")});var e=new Clipboard(".btn-copy-p");e.on("success",function(t){var a=t.trigger.value;t.trigger.value="已复制",setTimeout(function(){t.trigger.value=a},3e3)}),e.on("error",function(t){alert("复制失败，请手动操作。")})});