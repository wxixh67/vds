function loan(){var t=parseFloat($("#amount").val());if(isNaN(t))return tips_error("请填写贷款金额！"),$("#amount").focus(),$("#amount").select(),$("#tool-result").hide(),!1;var r=parseInt($("#year").val());if(isNaN(r)||r<1)return tips_error("请填写贷款年限，大于1。"),$("#year").focus(),$("#year").select(),$("#tool-result").hide(),!1;var e=parseFloat($("#rate").val());if(isNaN(e))return tips_error("请填写年利率，若无填0。"),$("#rate").focus(),$("#rate").select(),$("#tool-result").hide(),!1;var a=$("input[name='type']:checked").val(),o=10*e/12,l=12*parseInt(r),s="";0==a?(result=estateBorrow(t,o,l),s+="每月还款本金："+result[4]+" 元<br/>",s+="每月支付利息："+result[2]+" 元<br/>",s+="每月还款金额："+result[0]+" 元<br/>",s+="累计支付利息："+result[3]+" 元<br/>"):(result=estateBorrow1(t,o,l),console.log(result),s+="累计支付利息："+result[0]+" 元<br/>"),s+="累计还款总额："+result[1]+" 元",tips_clear(),$("#tool-result").show(),$("#tool-result").html(s)}function estateBorrow(t,r,e){if(0==r)s=l=0,a=b=(o=t)/e,l=toDecimal2(l),s=toDecimal2(s),a=toDecimal2(a),o=toDecimal2(o),b=toDecimal2(b);else{var a=t*r*.001*Math.pow(1+parseFloat(.001*r),parseFloat(e))/(Math.pow(1+parseFloat(.001*r),parseFloat(e))-1),o=a*e,l=o-t,s=l/e;b=a-s,l=toDecimal2(l),s=toDecimal2(s),a=toDecimal2(a),o=toDecimal2(o),b=toDecimal2(b)}var i=new Array;return i[0]=a,i[1]=o,i[2]=s,i[3]=l,i[4]=b,i}function estateBorrow1(t,r,e){for(var a=parseInt(e),o=0,l=1;l<a+1;l++){var s=(t-t*(l-1)/a)*r*.001;o=parseFloat(o)+parseFloat(s)}Math.pow(1+parseFloat(.001*r),parseFloat(e)),Math.pow(1+parseFloat(.001*r),parseFloat(e)),o=toDecimal2(o);var i=toDecimal2(parseFloat(t)+parseFloat(o)),u=new Array;return u[0]=o,u[1]=i,u}function isNumber(t){return!(!/^\d+(\.\d+)?$/.test(t)&&!/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(t))}function toDecimal2(t){var r=parseFloat(t);if(isNaN(r))return!1;var e=(r=Math.round(100*t)/100).toString(),a=e.indexOf(".");for(a<0&&(a=e.length,e+=".");e.length<=a+2;)e+="0";return e}