<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Outlook/Hotmail邮件读取工具</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="author" content="在线工具网站" />
	<meta name="keywords" content="2FA,2fa,2fa在线工具,双重验证工具,汇率换算,世界时间,文本处理工具,FB账号批量检测,facebook批量检测,在线工具" />
	<meta name="description" content="本站所有在线工具免费使用，旨在方便大家做业务。工具主要有：2FA验证码获取、汇率换算、文本处理、节假日倒计时。" />
	<link rel="apple-touch-icon" sizes="144x144" href="https://2fa.run/assets/images/favicons/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="57x57" href="https://2fa.run/assets/images/favicons/apple-touch-icon-57x57.png">
	<link rel="shortcut icon" href="https://2fa.run/assets/images/favicons/tools.png" type="image/png">
	<link rel="stylesheet" type="text/css" href="https://2fa.run/assets/styles/style.css" />
<style>
* { word-break: break-all;}
a,a:hover{text-decoration: none;}
textarea,input,button,select{width:100%;padding:10px;box-sizing:border-box;}
textarea{height:88px!important;background-color: #F7F9FA; border: 0px; border-radius: 0.55rem;padding:2px 4px; box-shadow: none; color: #5E6E80;width: 100%; box-shadow: inset 0px 0px 1px 1px rgb(50 174 77);font-size: 0.85rem;}
input{border:none;border-radius: 0.55rem;padding:3px 6px;box-shadow: none; color: #5E6E80;width: 100%; box-shadow: inset 0px 0px 1px 1px rgb(50 174 77);}
li { list-style-type: none;}
body{font-family:Arial,Helvetica,Segoe UI,sans-serif;}
label{font-weight:bold;display:block;margin:12px 0 6px;}
button{cursor:pointer;background-image: linear-gradient(142.17deg, #009688 6.66%, #00d708de 91.48%); box-shadow: inset -0.25rem -0.25rem 0.3125rem rgba(0, 0, 0, 0.1), inset 0.25rem 0.25rem 0.3125rem rgba(255, 255, 255, 0.23); border-radius: 0.35rem; border: 0; color: #fff; cursor: pointer; font-size: 1rem; font-weight: 600; padding: 0.23rem 0.86rem;margin:28px 0 0 0;}
.card{border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin:16px 0;box-shadow:0 1px 3px rgba(0,0,0,.05)}
.small{color:#6b7280;font-size:12px}
.mail{border:1px solid #e5e7eb;border-radius:12px;padding:14px;margin:14px 0; overflow: auto;}
.mail li { float: none; list-style: disc; margin-left: 1.2em; }
.mail ul, .mail ol { margin: .5em 0 .5em 1.2em; padding: 0; }
.mail img { max-width: 100%; height: auto; display: inline-block; }
.mail table { max-width: 100%; border-collapse: collapse; }
.mail details { overflow: auto; } 
.mail .meta{color:#6b7280;font-size:12px;margin-bottom:8px}
details summary{cursor:pointer}
</style>
</head>
<body>
    <div class="container gutter-top note-edit">
			<div class="row sticky-parent">
				<aside class="col-12 col-md-12 col-lg-2">
					<div class="sidebar box sticky-column">
						<ul class="nav">
							<li class="nav__item"><a href="../index.html"><i class="icon-key"></i>2FA工具</a></li>
							<li class="nav__item"><a href="../note.html"><i class="icon-clipboard"></i>文本处理</a></li>
							<li class="nav__item"><a href="../work.html"><i class="icon-instagram1"></i>图片处理</a></li>
							<li class="nav__item"><a href="../money.html"><i class="icon-activity"></i>汇率换算</a></li>
							<li class="nav__item"><a class="active" href="../more.html"><i class="icon-more-horizontal"></i>更多工具</a></li>
						</ul>
					</div>
				</aside>
				<div class="col-12 col-md-12 col-lg-10">
					<div class="box box-content">
						<div class="pb-2">
							<a style="margin-right: 2rem;color:rgba(0,0,0,.85);" href="../more.html">
								<< 返回工具导航</a>
						</div>
						<hr>
						<div class="caption">
						    <h1 class="title title-style">Outlook/Hotmail邮件读取工具</h1>
						</div>
                        <div class="card" style="background-color: rgb(0 0 0 / 6%);">
                          <p>请输入包含此类格式的信息：邮箱---邮箱密码---token---client_id（支持2种分隔符号：--- 和 | ，允许带中文/英文注释，可随意输入多余数据段，工具会自动选择所需项目。）</p>
                          <p class="small">示例：[其他信息]---邮箱：abc@xxx.com---密码: password001---邮箱refresh_token值：M.C543...ABCD---client_id: 8b4b-67...c-dcf2---[其他信息]</p>
                        </div>
                        <form method="post" id="mailForm">
                          <label>输入邮箱数据：</label>
                          <textarea id="inputData" name="full_input" rows="3" required placeholder="支持 --- 或 | 分隔的数据，可带中英文注释直接粘贴" style="width: 100%; padding-right: 28px;"></textarea>
                          <span id="clearBtn" style="cursor: pointer; color: #ff7e7e;">点击此处清除全部内容</span>
                          <label>正文显示模式：</label>
                          <select name="body_mode">
                            <option value="auto" selected>自动选择</option>
                            <option value="text">仅纯文本</option>
                            <option value="html">安全HTML</option>
                          </select>

                          <label>最多展示邮件数量（默认 10）：</label>
                          <input type="number" name="limit" min="1" max="100" value="10">

                          <button type="submit">开始读取</button>
                        </form>

                        <div id="results"></div>

                        
                        <hr />
						<h3 class="title title--h5">邮件读取工具说明</h3>
						<p class="tip-p"><strong>使用提示</strong>：<span>支持GRAPH API和Ouath2这2种Token数据的邮箱获取邮件。每次仅支持1个邮箱读取邮件，暂不支持批量获取。可以同时获取收件箱和垃圾箱的内容。最多展示邮件数量为10的话，会显示最新的10封邮件。</span><br /><strong>其他说明</strong>：支持 <code>---</code> 或 <code>|</code> 分隔，且每段数据可带中文或英文注释（使用 中文<code>：</code> 或 英文<code>:</code>）。例如：<code>邮箱：x@outlook.com---密码: 123---refresh_token: M.C...xxxx---client_id: 9e5f...</code>。特别注意输入的数据中 邮箱---邮箱密码---token---client_id 这4项必须严格按照这个顺序排布，否则将无法读取邮箱。<br /><strong>最近维护</strong>：2025年08月28日
						</p>
					</div>
					<footer class="footer">©2025 在线工具</footer>
				</div>
			</div>
		</div>
	</div>
    <div class="back-to-top"></div>
    <script src="https://2fa.run/assets/js/jquery-3.4.1.min.js"></script>
	<script src="https://2fa.run/assets/js/plugins.min.js"></script>
	<script src="https://2fa.run/assets/js/common.js"></script>
	<script>
        // 点击清空按钮
        document.getElementById('clearBtn').addEventListener('click', function() {
            document.getElementById('inputData').value = '';
        });

        // 拦截表单，AJAX 提交（不刷新页面，不丢输入）
        document.getElementById('mailForm').addEventListener('submit', async (e) => {
          e.preventDefault();
          const form = e.target;
          const fd = new FormData(form);
          fd.append('ajax', '1'); // 让后端只返回片段

          const box = document.getElementById('results');
          box.innerHTML = '<div class="card" style="background-color:rgba(152 251 152);">正在加载，请稍候…</div>';

          try {
            const resp = await fetch(location.href, { method: 'POST', body: fd });
            const html = await resp.text();
            box.innerHTML = html;
          } catch (err) {
            box.innerHTML = '<p style="color:#b91c1c">请求失败：' + (err && err.message ? err.message : '网络错误') + '</p>';
          }
        });

        // AJAX 返回后可能含有多个 iframe，逐个自适应高度
        const resizeIframes = () => {
          document.querySelectorAll('iframe.mail-body').forEach(f => {
            try {
              const d = f.contentDocument || f.contentWindow.document;
              if (!d) return;
              const h = Math.max(200, d.documentElement.scrollHeight, d.body.scrollHeight);
              f.style.height = h + 'px';
            } catch (e) { /* ignore */ }
          });
        };
        const resultsBox = document.getElementById('results');
        const mo = new MutationObserver(() => setTimeout(resizeIframes, 50));
        mo.observe(resultsBox, { childList: true, subtree: true });
        document.addEventListener('click', (e) => {
          if (e.target && e.target.tagName === 'SUMMARY') {
            setTimeout(resizeIframes, 50);
          }
        });
    </script>
</body>
</html>